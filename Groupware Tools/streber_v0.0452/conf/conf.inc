<?php
/**
* misc settingss and configuration-variables
*
* Do not edit this file to customize! 
* - most db-settings are overwritten by .settings/db_settings.inc
* - use "customize.inc" in streber's root to overwrite any of this settings
*/



/**
* assoc. array holding initial configuration variables
*/
$g_config= array(

	'STREBER_VERSION'       => '0.0451',
	'STREBER_VERSION_DATE'  => '2005-09-08',


    'APP_NAME'              => 'STREBER',
    'APP_PAGE_URL'          => 'http://streber.sourceforge.net',
	'PHP_VERSION_REQUIRED'	=>	'5.0.0',
	'INCLUDE_PATH'		    => ".",
	'DIR_TEMP'              => "_tmp/",
    'DIR_SETTINGS'          => "_settings/",
	'FILE_DB_SETTINGS'      => 'db_settings.inc',
	
    /**
    * title diplay in header
    */
	'APP_TITLE_HEADER'      => "streber<span class=extend>PM</span>",
	
    /**
    * - the database version is stored in the db-table inside the row with updated=NULL
    * - this version is checked on installation and before logging in (if no cookie provided)
    *
    * - additionally the current db-version is set by DB_VERSION in _settings/db_settings.inc
    */
	'DB_VERSION_REQUIRED'   => '0.045',

	
    /**
    * url to online-help
    */
	'STREBER_WIKI_URL'      => 'http://wiki.pixtur.de/index.php/',
	
    /**
    * version of databases created by installation
	*
	* this fields are overwritten by settings/db_settings.inc which is
	* been created by "install/install.php"
	*
    */
    'HOSTNAME'              => 'localhost',
	'DB_CREATE_VERSION'     => '0.045',
	'DB_CREATE_STREBER_VERSION_REQUIRED' => '0.045',

    'DB_USERNAME'           =>'',
    'DB_PASSWORD'           =>'',
    'DB_NAME'               =>'',
    'DB_TABLE_PREFIX'       =>'',
    'DB_VERSION'            =>'',   # current version (set to DB_CREATE_VERSION at install) / validated at startup to complain for upgrade

	/**
	* minium required length/complexity of entered password
	*
	* numbers and special-chars weight more than normal chars, so values above 8 are ok
	*/
	'CHECK_PASSWORD_LEVEL'  => 8,

	/**
	* enable this will measure the microtimes for some rendering and db-processed
	* for those you explicitly have to add measure_start(id) and measure_stop(id) 
	* functions.
	*
	* see std/profile.inc
	*/
	'USE_PROFILER'          =>false,
	
    /**
    * NUMBER in theme-list
    */
	'THEME_DEFAULT'         =>0,
	
	
	/**
	* change this to client-theme, to make your presentation consistent
	*/
	'THEME_LOGIN'           =>0,
	'THEME_CLIENT_VIEW'     =>1,
	
    /**
    * additional message displayed at login-page
    * useful for display public accounts
    */
	'LOGIN_MESSAGE'         =>"",

    /**
    * size short names are truncated to
    */
    'STRING_LENGTH_SHORT'  =>8,
    
    /**
    * text displayed if streber can't start-up (db offline, wrong php-version, etc)
    * - it's a good habit to give the e-mail adresse of an administrator.
    */
    'MESSAGE_OFFLINE'=>"<h1>Congratulations!</h1>
                    You are one of the few people witnessing this installation of 
                    <a href='http://streber.sourceforge.net'>streber</a> being offline. Use your chance and contact
                    the <a href='mailto:admin @ is undefined com'>administrator</a> to get your special price emmidiately.<br><br>Problem: <b>",
	

    'MESSAGE_WELCOME_HOME'=>
                        "<b>Welcome</b> to streber.",

    'MESSAGE_WELCOME_ONEPROJECT'=>
                        "Hello <b>%s</b>. Welcome to project <b>%s</b> ",


    /**
    * list-color-settings (depend on javascript) overwritten by themes/XXX/theme_config.inc (included at render_page.inc)
    */
    'LIST_COLOR_ODD'        =>'#ffffff',
    'LIST_COLOR_EVEN'       =>'#f8f8f8',
    'LIST_COLOR_SELECTED'   =>'#d0ffd0',
    'LIST_COLOR_HOVER'      =>'#ffff80',


    
    /**
    * this sometimes slows down pageload for 10%-15% percent
    */
    'LINK_STYLE_PRINT'      => true,

);




/**
* define item-types in item-table
*
* @@@ move somewhere else 
*
*
*
*/
DEFINE('MAX_STORED_FROM_HANDLES',10);  # how many from-handles are stored in one file for each user in _tmp


define('RIGHT_PROJECT_CREATE',      1<<1);
define('RIGHT_PROJECT_EDIT',        1<<2);
define('RIGHT_PROJECT_ASSIGN',      1<<3);
define('RIGHT_PROJECT_DELETE',      1<<4);
define('RIGHT_PROJECT_VIEWALL',       1<<5);

define('RIGHT_PERSON_CREATE',       1<<8);      # creating persons includes right-editing
define('RIGHT_PERSON_EDIT',         1<<9);
define('RIGHT_PERSON_DELETE',       1<<10);
define('RIGHT_PERSON_VIEWALL',       1<<11);
define('RIGHT_PERSON_EDIT_RIGHTS',  1<<12);
define('RIGHT_PERSON_EDIT_SELF',  1<<13);

define('RIGHT_COMPANY_CREATE',      1<<16);
define('RIGHT_COMPANY_EDIT',        1<<17);
define('RIGHT_COMPANY_DELETE',      1<<18);
define('RIGHT_COMPANY_VIEWALL',      1<<19);

define('RIGHT_ALL',         0xfffffff);
define('RIGHT_NONE',         0);


/**
* database object types for item-table
*
* @@@ move somewhere else (but remind that it is required by "install/install.php"
*/
DEFINE('ITEM_PROJECT', 1);
DEFINE('ITEM_TASK', 2);
DEFINE('ITEM_PERSON', 3);
DEFINE('ITEM_PROJECTPERSON', 4);
DEFINE('ITEM_COMPANY', 5);
DEFINE('ITEM_EMPLOYMENT', 6);
DEFINE('ITEM_ISSUE', 7);
DEFINE('ITEM_EFFORT', 8);
DEFINE('ITEM_TASK_EFFORT', 9);
DEFINE('ITEM_COMMENT', 10);
DEFINE('ITEM_FILE', 11);
DEFINE('ITEM_DEADLINE', 12);
DEFINE('ITEM_VERSION', 13);
DEFINE('ITEM_APPOINTMENT', 14);

$g_item_names=array(
    ITEM_PROJECT    =>'project',
    ITEM_TASK       =>'task',
    ITEM_PERSON     =>'person',
    ITEM_PROJECTPERSON=>'teammember',
    ITEM_COMPANY    =>'company',
    ITEM_EMPLOYMENT =>'employment',
    ITEM_ISSUE      =>'issue',
    ITEM_EFFORT     =>'effort',
    ITEM_TASK_EFFORT=>'task_effort',
    ITEM_COMMENT    =>'comment',
    ITEM_FILE       =>'file',
    ITEM_DEADLINE   =>'deadline',
    ITEM_VERSION    =>'version',
    ITEM_APPOINTMENT=>'appointment',
);


/**
* @@@ move somewhere else
*/
define('PUB_LEVEL_NONE',           0);
define('PUB_LEVEL_PRIVATE',        1);
define('PUB_LEVEL_SUGGESTED',      2);
define('PUB_LEVEL_INTERNAL',       3);
define('PUB_LEVEL_OPEN',           4);
define('PUB_LEVEL_CLIENT',    5);
define('PUB_LEVEL_CLIENTEDIT',  6);
define('PUB_LEVEL_ASSIGNED',    100);
define('PUB_LEVEL_OWNED',    101);
define('PUB_LEVEL_NOTHING',    127);

$PUB_LEVEL_VALUES=array(
'undefined' => PUB_LEVEL_NONE,
'private'   => PUB_LEVEL_PRIVATE,
'suggested' => PUB_LEVEL_SUGGESTED,
'internal'  => PUB_LEVEL_INTERNAL,
'open'      => PUB_LEVEL_OPEN,
'client'    => PUB_LEVEL_CLIENT,
'cliend_edit'=> PUB_LEVEL_CLIENTEDIT,
'assigned'  => PUB_LEVEL_ASSIGNED,
'owned'     => PUB_LEVEL_OWNED,
);

$PUB_LEVEL_SHORT_NAMES=array(
PUB_LEVEL_NONE=>'.',
PUB_LEVEL_PRIVATE=>'priv',
PUB_LEVEL_SUGGESTED=>'?',
PUB_LEVEL_INTERNAL=>'int',
PUB_LEVEL_OPEN=>' ',
PUB_LEVEL_CLIENT=>'pub',
PUB_LEVEL_CLIENTEDIT=>'PUB',
PUB_LEVEL_ASSIGNED=>'A',
PUB_LEVEL_OWNED=>'O',
);

$PUB_LEVEL_NAMES=array_flip($PUB_LEVEL_VALUES);



/**
* @@@ move somewhere else
*/
$USER_RIGHT_VALUES=array(
    'Create projects'       =>RIGHT_PROJECT_CREATE,
    'Edit projects'         =>RIGHT_PROJECT_EDIT,
    'Delete projects'       =>RIGHT_PROJECT_DELETE,
    'Edit project teams'       =>RIGHT_PROJECT_ASSIGN,
    'View all projects'       =>RIGHT_PROJECT_VIEWALL,

    'Create Persons'        =>RIGHT_PERSON_CREATE,
    'Edit Presons'          =>RIGHT_PERSON_EDIT,
    'Delete Persons'        =>RIGHT_PERSON_DELETE,
    'View all Persons'       =>RIGHT_PERSON_VIEWALL,
    'Edit User Rights'      =>RIGHT_PERSON_EDIT_RIGHTS,
    'Edit Own Profil'      =>RIGHT_PERSON_EDIT_SELF,

    'Create Companies'      =>RIGHT_COMPANY_CREATE,
    'Edit Companies'        =>RIGHT_COMPANY_EDIT,
    'Delete Companies'      =>RIGHT_COMPANY_DELETE,
);




$g_themes=array(
    'default'=>'Default',
    'forclients' =>'Client Theme',
    
);
$g_theme_names=array_keys($g_themes);


$SEVERITY_VALUES=array(
    'undefined'   => 0,
    'nitpicky'   => 1,
    'feature'   => 2,
    'trivial'   => 3,
    'text'      => 4,
    'tweak'     => 5,
    'minor'     => 6,
    'major'     =>7,
    'crash'     =>8,
    'block'     =>9,
);

$REPRODUCIBILITY_VALUES=array(
    'undefined'                 => 0,
    'not available'             => 1,
    'always'                    => 2,
    'sometimes'                 => 3,
    'have_not_tried'            => 4,
    'unable_to_reproduce'       => 5,
);





/**
* default role when added to projects
* 
* Don't get confuse about User-rights, user-profile and project-rights.
* Profiles are some kind of template to quickly INITIALIZE user-rights
* and project-roles. These values are COPIED into the "person.user_rights"
* and the "projectperson.*_level".
*
* Don't be affraid to add new profiles here, but keep up the order of
* already assigned profiles.
*
* @@@ mental-note on g_user_profiles:
* - we could use this to customize the views for different people 
*   (not styling with themes, but hiding complete blocks, functions, etc.)
*
* get profile like this:
*
* $profile=$g_user_profiles[ $g_user_profile_names[$person->profile] ];
*
* when initializing projectPersons, all defined (and useful) settings of 
* the profile are copied. To avoid reinitiating, comment the lines.
*/
$g_user_profiles=array(
    'undefined'=>array(
        'job_name'              =>'member',
        'default_project_role'  =>'member',
        'level_create'          => PUB_LEVEL_OPEN,
        'level_edit'            => PUB_LEVEL_OPEN,
        'level_view'            => PUB_LEVEL_OPEN,
        'level_delete'          => PUB_LEVEL_PRIVATE,
        'level_reduce'          => PUB_LEVEL_OPEN,
    ),
    'admin'=>array(
        'job_name'              =>'Admin',
        'default_project_role'  =>'admin',
        'default_user_rights'   =>RIGHT_ALL,
        'level_view'            => PUB_LEVEL_SUGGESTED,
        'level_create'          => PUB_LEVEL_CLIENTEDIT,
        'level_edit'            => PUB_LEVEL_SUGGESTED,
        'level_delete'          => PUB_LEVEL_SUGGESTED,
        'level_reduce'          => PUB_LEVEL_PRIVATE,
    ),
    'project manager'=>array(
        'new_project_role'      =>'admin',
        'job_name'              =>'PM',
        'default_user_rights'   =>RIGHT_ALL| 1^RIGHT_PERSON_EDIT_RIGHTS ,
        'level_view'            => PUB_LEVEL_SUGGESTED,
        'level_create'          => PUB_LEVEL_CLIENTEDIT,
        'level_edit'            => PUB_LEVEL_SUGGESTED,
        'level_delete'          => PUB_LEVEL_SUGGESTED,
        'level_reduce'          => PUB_LEVEL_PRIVATE,
    ),
    'user'=>array(
        'job_name'              =>'member',
        'new_project_role'      =>'member',
        'default_user_rights'   =>RIGHT_PERSON_EDIT_SELF,
        'level_create'          => PUB_LEVEL_OPEN,
        'level_edit'            => PUB_LEVEL_OPEN,
        'level_view'            => PUB_LEVEL_OPEN,
        'level_delete'          => PUB_LEVEL_PRIVATE,
        'level_reduce'          => PUB_LEVEL_OPEN,
    ),
    'developer'=>array(
        'job_name'              =>'Developer',
        'new_project_role'      =>'member',
        'default_user_rights'   => RIGHT_PERSON_EDIT_SELF|RIGHT_PROJECT_EDIT|RIGHT_PERSON_EDIT,
        'level_create'          => PUB_LEVEL_OPEN,
        'level_edit'            => PUB_LEVEL_OPEN,
        'level_view'            => PUB_LEVEL_OPEN,
        'level_delete'          => PUB_LEVEL_PRIVATE,
        'level_reduce'          => PUB_LEVEL_OPEN,
    ),
    'artist'=>array(
        'job_name'              =>'Arist',
        'new_project_role'      =>'member',
        'default_user_rights'   =>RIGHT_PERSON_EDIT_SELF,
        'level_create'          => PUB_LEVEL_OPEN,
        'level_edit'            => PUB_LEVEL_OPEN,
        'level_view'            => PUB_LEVEL_OPEN,
        'level_delete'          => PUB_LEVEL_PRIVATE,
        'level_reduce'          => PUB_LEVEL_OPEN,
    ),
    'tester'=>array(
        'job_name'              =>'Tester',
        'new_project_role'      =>'member',
        'default_user_rights'   =>RIGHT_PERSON_EDIT_SELF,
        'level_create'          => PUB_LEVEL_OPEN,
        'level_edit'            => PUB_LEVEL_OPEN,
        'level_view'            => PUB_LEVEL_OPEN,
        'level_delete'          => PUB_LEVEL_PRIVATE,
        'level_reduce'          => PUB_LEVEL_OPEN,
    ),
    'client'=>array(
        'job_name'              =>'Client',
        'new_project_role'      =>'client',
        'default_user_rights'   => RIGHT_PERSON_EDIT_SELF,
        'level_create'          => PUB_LEVEL_SUGGESTED,
        'level_edit'            => PUB_LEVEL_OWNED,
        'level_view'            => PUB_LEVEL_CLIENT,
        'level_delete'          => PUB_LEVEL_NOTHING,
        'level_reduce'          => PUB_LEVEL_NOTHING,
        'hide_clientview'       => true,
    ),
    'client_trust'=>array(
        'job_name'              =>'Trusted Client',
        'new_project_role'      =>'client',
        'default_user_rights'   => RIGHT_PERSON_EDIT_SELF,
        'level_create'          => PUB_LEVEL_SUGGESTED,
        'level_edit'            => PUB_LEVEL_CLIENTEDIT,
        'level_view'            => PUB_LEVEL_OPEN,
        'level_delete'          => PUB_LEVEL_CLIENTEDIT,
        'level_reduce'          => PUB_LEVEL_NOTHING,
    ),
    'guest'=>array(
        'job_name'              =>'Guest',
        'new_project_role'      =>'guest',
        'default_user_rights'   => RIGHT_NONE,
        'level_create'          => PUB_LEVEL_SUGGESTED,
        'level_edit'            => PUB_LEVEL_NOTHING,
        'level_view'            => PUB_LEVEL_CLIENT,
        'level_delete'          => PUB_LEVEL_NOTHING,
        'level_reduce'          => PUB_LEVEL_NOTHING,
    
    ),
);
$g_user_profile_names=array_keys($g_user_profiles);


#
#  NOTE states should actually be a property of projects. This is a hack...
#
$STATUS_VALUES=array(
'template'=> -1,
'undefined'=>0,
'upcoming'=>1,
'planned'=>2,
'open'=>3,
'onhold'=>4,
'completed'=>5,
'approved'=>6,
'closed'=>8,
);
$STATUS_NAMES=array_flip($STATUS_VALUES);

#
#  NOTE states should actually be a property of projects. This is a hack...
#
$COMMENTTYPE_VALUES=array(
'undefined'=>0,
'Comment'=>1,
'Reply'=>2,
'Conversation'=>3,
'Phone'=>4,
'Meeting'=>5,
'Idea'=>6,
);
$COMMENTTYPE_NAMES=array_flip($COMMENTTYPE_VALUES);


$PRIORITY_VALUES=array(
'undefined'=>0,
'urgend'=>1,
'high'=>2,
'normal'=>3,
'lower'=>4,
'lowest'=>5,
);
$PRIORITY_NAMES=array_flip($PRIORITY_VALUES);


$g_security_questions=array(
'in your youth you wanted to become a...',
'person you would like to kick in the ass...',
'your favorit car is a...',
'your best vacation was in...',
);


/**
* get an configuration-variable. Complain if not defined.
*
* @@@put this function somewhere else
*/
function confGet($var) {
	global $g_config;
	if(isset($g_config[$var])) {
		return $g_config[$var];
	}
	else {
	    trace("notice","requesting undefined config variable $var");
	}
	return NULL;
}

/**
* changes a configuration-variable, but complains if not defined
*
* @@@put this function somewhere else
*/
function confChange($var,$value) {
	global $g_config;
	if(!isset($g_config[$var]) && !is_null($g_config[$var])) {
	    trace("notice","confChange set undefined variable '$var' to '$value'"); 
	}
    $g_config[$var]= $value;
    return true;
}

/**
* return a valid link to streber's wiki documentation...
*
* @@@put this function somewhere else
*/
function getStreberWikiLink($pagename=NULL,$displayname=NULL) {
    if(!$pagename) {
        trace("notice","getStreberWikiLink() requires pagename");
    }
    if(!$displayname) {
        $displayname= $pagename;
    }
    return "<a href=\"". confGet('STREBER_WIKI_URL')."$pagename\">$displayname</a>";
}










?>
