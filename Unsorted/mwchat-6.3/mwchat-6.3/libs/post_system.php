<?PHP
  function Post_System($szPostMsg, $szPostType, $szPostroom) { global $CONN; global $CONFIG; global $Username; $szPostMsg = Profanity_Check($szPostMsg, "clean"); if ($szPostType == "global") { $szPostMsg = "<FONT COLOR=\"$CONFIG[Color_SystemGlobalMessage]\">$szPostMsg</FONT COLOR>"; $szPostMsg = addslashes($szPostMsg); $rgUsers_SELECT = db_query(Validate(9), $CONN); while($rgUsers = db_fetch($rgUsers_SELECT)) { $szEncryptMsg = Encryption("encode", $szPostMsg, $rgUsers[username], ""); $rgText_INSERT = db_query("INSERT INTO chat_text VALUES(NULL, '$rgUsers[username]', 'POST-SYSTEM-GLOBAL', 'no', '$rgUsers[room]', '$szEncryptMsg[0]', '$szEncryptMsg[1]', NULL)", $CONN); } } elseif ($szPostType == "local") { $szPostMsg = "<FONT COLOR=\"$CONFIG[Color_SystemLocalMessage]\">$szPostMsg</FONT COLOR>"; $szPostMsg = addslashes($szPostMsg); $rgUsers_SELECT = db_query("SELECT username FROM chat_users WHERE room='$szPostroom'", $CONN); while($rgUsers = db_fetch($rgUsers_SELECT)) { $szEncryptMsg = Encryption("encode", $szPostMsg, $rgUsers[username], ""); $rgText_INSERT = db_query("INSERT INTO chat_text VALUES(NULL, '$rgUsers[username]', 'POST-SYSTEM-LOCAL', 'no', '$szPostroom', '$szEncryptMsg[0]', '$szEncryptMsg[1]', NULL)", $CONN); } } else { $szPostMsg = "<FONT COLOR=\"$CONFIG[Color_SystemSyntaxMessage]\">$szPostMsg</FONT COLOR>"; $szPostMsg = addslashes($szPostMsg); $szEncryptMsg = Encryption("encode", $szPostMsg, $Username, ""); $rgText_INSERT = db_query("INSERT INTO chat_text VALUES(NULL, '$Username', 'POST-SYSTEM-SYNTAX', 'no', '$szPostroom', '$szEncryptMsg[0]', '$szEncryptMsg[1]', NULL)", $CONN); } } ?>
