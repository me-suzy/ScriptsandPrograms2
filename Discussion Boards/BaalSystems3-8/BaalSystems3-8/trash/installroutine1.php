<?php$browser_string=$HTTP_USER_AGENT;$client_ip=gethostbyname(localhost);session_start();      if(session_is_registered("whossession"))      {        $_SESSION['who']="admin";        $_SESSION['username']="admin";      }      else      {        session_register("whossession");        $_SESSION['who']="admin";        $_SESSION['username']="admin";      }?><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head>  <title>Baal Smart Form</title><link rel="STYLESHEET" type="text/css" href="helpdeskrevolutions.css"></head><!-- <body bgcolor="#E5E5E5" leftmargin="3" topmargin="0"> --><body bgcolor="#FFFFFF" leftmargin="0" topmargin="0"><table border="0" cellspacing="0" width="100%"><tr>    <td bgcolor="#6C9CFF" valign="top">        <table border="0" cellpadding="2" cellspacing="0" height="100%">        <tr><td align="right" valign="bottom">                <font size="3" face="Comic Sans MS, Trebuchet MS, Verdana, Tahoma, Arial" color="#FFFFFF"><h2>&nbsp;Baal Smart Form</h2></font>        </td></tr>        </table>    </td></tr></table><?phpextract ($HTTP_POST_VARS,EXTR_OVERWRITE) ;extract ($HTTP_GET_VARS,EXTR_OVERWRITE) ;global $_force;$dbhost = "$dbservername";$dbusername = "$dbusername";$dbuserpassword = "$dbpassword";$default_dbname = "$dbname";$MYSQL_ERRNO = "";$MYSQL_ERROR = "";$_softup = $softup ;if( $softup ){	$filename = 'dataaccess.php';	if (!$datafile = fopen($filename, 'w'))	{	         echo "Cannot open file ($filename)";	         exit;	}	else	{		    $strcontent = "<?php ";	    $strcontent = $strcontent . "\$dbservername=\"".$HTTP_POST_VARS[dbservername]."\" ;" ;	    $strcontent = $strcontent . "\$dbusername=\"".$HTTP_POST_VARS[dbusername]."\" ;" ;	    $strcontent = $strcontent . "\$dbpassword=\"".$HTTP_POST_VARS[dbpassword]."\" ;" ;	    $strcontent = $strcontent . "\$dbname=\"".$HTTP_POST_VARS[dbname]."\" ;" ;	    $strcontent = $strcontent . " ?>";	    fwrite($datafile, $strcontent , strlen($strcontent));	    fclose($datafile);	}	$filename1 = 'dataaccess1.php';	if (!$datafile1 = fopen($filename1, 'w'))	{	         echo "Cannot open file ($filename1)";	         exit;	}	else	{	  $strcontent1 = "<?php";	  $strcontent1 = $strcontent1 . " function dbConnect(){";	  $strcontent1 = $strcontent1 . "\$link=mysql_connect('{$_POST['dbservername']}','{$_POST['dbusername']}' , '{$_POST['dbpassword']}');";	  $strcontent1 = $strcontent1 . "if (!\$link)";	  $strcontent1 = $strcontent1 . "{ Error_handler('Error connecting to database server' , \$link ); } ";	  $strcontent1 = $strcontent1 . "mysql_select_db('{$_POST['dbname']}', \$link);}";	  $strcontent1 .= "\$tableprefix = $_POST['tableprefix']_; ?>";	  /*$strcontent  = addslashes($strcontent)*/	  fwrite($datafile1, $strcontent1 , strlen($strcontent1));	  fclose($datafile1);	}			if( @mysql_connect($dbservername,$dbusername,$dbpassword ) )	{	   if(! @mysql_select_db($dbname))	      {	        die (" Data base doesn't exists. ") ;	    }	}	else	{	       die ("***Not connected*** ") ;	}	echo "Data base references updated " ;	echo "<br>" ;	?>	<br>	<br>	<br>	<a href ="regadmin.php">Proceed...</a> as administrator	<?php	return ;}$_force = $force ;if ( ! $force )    $_force = "N" ;function db_connect(){	global $dbhost,$dbusername,$dbuserpassword,$default_dbname;	global $MYSQL_ERRNO,$MYSQL_ERROR,$_force ;	$link_id=@mysql_connect($dbhost,$dbusername,$dbuserpassword);	if( $link_id == 0 )	    return 0 ;	echo "<center>" ;	$ok = false ;	if ( $_force )	{	    if ( $_force == "Y" )	    {	        $ok = false ;	        echo "<br><br>FORCE CREATION ENABLED. (tables will be replaced if found)<br><br>" ;	        }	           else	    {	        $ok = mysql_select_db($default_dbname) ;	        $_force = "" ;	    }	}	else	{	    $ok = mysql_select_db($default_dbname) ;	    $_force = "" ;	}	if( ! $ok )	{	        $querydb="create database $default_dbname" ;	        $resultdb=mysql_query($querydb);	        if(mysql_select_db($default_dbname) == false)	            {	            $MYSQL_ERRNO=mysql_errno();	            $MYSQL_ERROR=mysql_error();	            echo "connection failed @ stage2.<br>" ;	            return 0;	        }	    $dbname=$default_dbname;	}	else	{	    echo "<br><br>Data Base already exists. Use FORCE CREATE to overwrite";	?>	&nbsp;&nbsp;&nbsp;[ <a href="install.php">Re-try</a> ]<br><br>	<?php	return;	}	return $link_id;}if($_POST['installtype'] == freshinstall){	$pot = "yes";}else if($_POST['update'] == update){	$pot = "no";}else{	echo "No Install Type Chosen dummy!<br />";}$link_id=db_connect();if($link_id){/*//to create access tableif ( $_force == "Y" )mysql_query( "DROP TABLE tbluser" ) ;$querya = "CREATE TABLE tbluser (userid INT NOT NULL AUTO_INCREMENT ,username VARCHAR( 40 ) NOT NULL ,password VARCHAR( 40 ) ,userrole VARCHAR( 20 ) NOT NULL,mail VARCHAR( 60 ) ,PRIMARY KEY ( userid ))";$resulta = mysql_query($querya) ;if ( $_force == "Y" )mysql_query( "DROP TABLE tblgroup" ) ;$querys = " CREATE TABLE tblgroup (groupid INT NOT NULL AUTO_INCREMENT ,groupname VARCHAR( 80 ) NOT NULL ,PRIMARY KEY ( groupid ) )";$results = mysql_query($querys) ;if ( $_force == "Y" )mysql_query( "DROP TABLE tblforum" ) ;$queryas= " CREATE TABLE tblforum (forumid INT NOT NULL AUTO_INCREMENT ,groupname VARCHAR(80) ,subject VARCHAR( 100 ) ,authorname VARCHAR( 60 ) ,detail TEXT,lastpost DATETIME ,totalpost INT(11),views INT(11),PRIMARY KEY ( forumid ) )";$resultas=mysql_query($queryas) ;mysql_query( "DROP TABLE tblsubforum" ) ;$queryass= " CREATE TABLE tblsubforum (subforumid INT NOT NULL AUTO_INCREMENT ,forumid INT(11),groupname VARCHAR( 80 ) ,subject VARCHAR( 100 ) ,authorname VARCHAR( 60 ) ,dateposted DATETIME ,detail TEXT,PRIMARY KEY ( subforumid ))";$resultass=mysql_query($queryass) ;$filename = 'dataaccess.php';if (!$datafile = fopen($filename, 'w')){         echo "Cannot open file ($filename)";         exit;}else{    $strcontent = "<?php ";    $strcontent = $strcontent . "\$dbservername=\"".$HTTP_POST_VARS[dbservername]."\" ;" ;    $strcontent = $strcontent . "\$dbusername=\"".$HTTP_POST_VARS[dbusername]."\" ;" ;    $strcontent = $strcontent . "\$dbpassword=\"".$HTTP_POST_VARS[dbpassword]."\" ;" ;    $strcontent = $strcontent . "\$dbname=\"".$HTTP_POST_VARS[dbname]."\" ;" ;     $strcontent = $strcontent . " ?>";    fwrite($datafile, $strcontent , strlen($strcontent));    fclose($datafile);}$filename1 = 'dataaccess1.php';if (!$datafile1 = fopen($filename1, 'w')){         echo "Cannot open file ($filename1)";         exit;}else{  $strcontent1 = "<?php";  $strcontent1 = $strcontent1 . " function dbConnect(){";  $strcontent1 = $strcontent1 . "\$link=mysql_connect('{$_POST['dbservername']}','{$_POST['dbusername']}' , '{$_POST['dbpassword']}');";  $strcontent1 = $strcontent1 . "if (!\$link)";  $strcontent1 = $strcontent1 . "{ Error_handler('Error connecting to database server' , \$link ); } ";  $strcontent1 = $strcontent1 . "mysql_select_db('{$_POST['dbname']}', \$link);}?>";  //$strcontent  = addslashes($strcontent)  fwrite($datafile1, $strcontent1 , strlen($strcontent1));  fclose($datafile1);}*/echo "Data Base successfully created !";echo "<br><br>";?><br><br><br><a href ="regadmin.php">Proceed...</a> as administrator<?php}else echo "** Not connected **" ;?></body></html>