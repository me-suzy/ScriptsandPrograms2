<html>
<head>
<title>{$lang_insert_image_title}</title>
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Cache-Control" content="no-cache, must-revalidate, max_age=0" />
<meta http-equiv="Expires" content="0" />
<script language="javascript" type="text/javascript" src="../../tiny_mce_popup.js"></script>
<script language="javascript">
var url = tinyMCE.getParam("external_image_list_url");
if (url != null)
	document.write('<sc'+'ript language="javascript" type="text/javascript" src="' + tinyMCE.documentBasePath + "/" + url + '"></sc'+'ript>');
</script>
<script language="javascript" type="text/javascript">
<!--
	// Disable auto resize
	tinyMCE.getWindowArg('mce_windowresize', false);

	function insertImage() {
		if (window.opener) {
			var src = document.forms[0].src.value;
			var alt = document.forms[0].alt.value;
			var border = document.forms[0].border.value;
			var vspace = document.forms[0].vspace.value;
			var hspace = document.forms[0].hspace.value;
			var width = document.forms[0].width.value;
			var height = document.forms[0].height.value;
			var align = document.forms[0].align.options[document.forms[0].align.selectedIndex].value;

			window.opener.tinyMCE.insertImage(src, alt, border, hspace, vspace, width, height, align);
			top.close();
		}
	}

	function init() {
		var formObj = document.forms[0];

		for (var i=0; i<document.forms[0].align.options.length; i++) {
			if (document.forms[0].align.options[i].value == tinyMCE.getWindowArg('align'))
				document.forms[0].align.options.selectedIndex = i;
		}

		formObj.src.value = tinyMCE.getWindowArg('src');
		formObj.alt.value = tinyMCE.getWindowArg('alt');
		formObj.border.value = tinyMCE.getWindowArg('border');
		formObj.vspace.value = tinyMCE.getWindowArg('vspace');
		formObj.hspace.value = tinyMCE.getWindowArg('hspace');
		formObj.width.value = tinyMCE.getWindowArg('width');
		formObj.height.value = tinyMCE.getWindowArg('height');
		formObj.insert.value = tinyMCE.getLang('lang_' + tinyMCE.getWindowArg('action'), 'Insert', true); 

		// Handle file browser
		if (tinyMCE.getParam("file_browser_callback") != null) {
			document.getElementById('src').style.width = '180px';

			var html = '';

			html += '<img id="browserBtn" src="images/browse.gif"';
			html += ' onmouseover="tinyMCE.switchClass(this,\'mceButtonOver\');"';
			html += ' onmouseout="tinyMCE.restoreClass(this);"';
			html += ' onmousedown="tinyMCE.restoreAndSwitchClass(this,\'mceButtonDown\');"';
			html += ' onclick="javascript:tinyMCE.openFileBrowser(\'src\',document.forms[0].src.value,\'image\',window);"';
			html += ' width="20" height="18" border="0" title="' + tinyMCE.getLang('lang_browse') + '"';
			html += ' class="mceButtonNormal" alt="' + tinyMCE.getLang('lang_browse') + '" />';

			document.getElementById('browser').innerHTML = html;
		}

		// Auto select image in list
		if (typeof(tinyMCEImageList) != "undefined" && tinyMCEImageList.length > 0) {
			for (var i=0; i<formObj.image_list.length; i++) {
				if (formObj.image_list.options[i].value == tinyMCE.getWindowArg('src'))
					formObj.image_list.options[i].selected = true;
			}
		}

		// Autoresize and focus
		TinyMCEPopup_autoResize();
		window.focus();
	}

	function cancelAction() {
		top.close();
	}

	var preloadImg = new Image();

	function resetImageData() {
		var formObj = document.forms[0];
		formObj.width.value = formObj.height.value = "";	
	}

	function updateImageData() {
		var formObj = document.forms[0];

		if (formObj.width.value == "")
			formObj.width.value = preloadImg.width;

		if (formObj.height.value == "")
			formObj.height.value = preloadImg.height;
	}

	function getImageData() {
		preloadImg = new Image();
		tinyMCE.addEvent(preloadImg, "load", updateImageData);
		tinyMCE.addEvent(preloadImg, "error", function () {var formObj = document.forms[0];formObj.width.value = formObj.height.value = "";});
		preloadImg.src = tinyMCE.convertRelativeToAbsoluteURL(tinyMCE.settings['base_href'], document.forms[0].src.value);
	}


	function hideLayer(whichLayer) {
		if (document.getElementById) {
			// this is the way the standards work
			document.getElementById(whichLayer).style.display = "none";
		}
		else if (document.all) {
			// this is the way old msie versions work
			document.all[whichlayer].style.display = "none";
		}
		else if (document.layers) {
			// this is the way nn4 works
			document.layers[whichLayer].display = "none";
		}
	}

	function showLayer(whichLayer) {
			//	alert(whichLayer);
		if (document.getElementById) {
			// this is the way the standards work
			document.getElementById(whichLayer).style.display = "block";
		}
		else if (document.all) {
			// this is the way old msie versions work
			document.all[whichlayer].style.display = "block";
		}
		else if (document.layers) {
			// this is the way nn4 works
			document.layers[whichLayer].display = "block";
		}
	}

	function MM_findObj(n, d) { //v4.01
		var p,i,x;
		if(!d) d=document;
		if((p=n.indexOf("?"))>0&&parent.frames.length) {
			d=parent.frames[n.substring(p+1)].document;
			n=n.substring(0,p);
		}
		if(!(x=d[n])&&d.all)
			x=d.all[n];
		for (i=0;!x&&i<d.forms.length;i++)
			x=d.forms[i][n];
		for(i=0;!x&&d.layers&&i<d.layers.length;i++)
			x=MM_findObj(n,d.layers[i].document);
		if(!x && d.getElementById)
			x=d.getElementById(n);
		return x;
	}
//-->
</script>
</head>
<body onload="window.focus();init();"> 
<form onsubmit="insertImage();return false;">
<table class="dialog" border="0" cellpadding="0" cellspacing="5">
  <tr>
    <td>
			<table name="manager" border="0" cellpadding="0" cellspacing="0">
        <tr>
          <td class="manager" colspan="3" align="center" valign="middle">
						<table border=0	 cellspacing=0 cellpadding=0 width=100%>
							<tr>
								<td style="width: 18em;" valign=top>
									<fieldset>
										<legend align="left">Available images</legend>
										<iframe class="lister" name="lister" id="lister" src="lister.php?DPI=72" marginwidth="0" marginheight="0" style=" font: 9pt 'MS Shell Dlg', Helvetica, sans-serif; width: 18em; height:14em; padding:0px; margin:0px;" frameborder="0"></iframe>
                    <iframe class="viewer" name="viewer" marginwidth="0" marginheight="0" style="display:none"></iframe>
									</fieldset>
								</td>
								<td valign=top style="padding: 0px 0px 0px 7px;">
									<!-- empty header -->
									<div id="emptyheader" style="DISPLAY: block"></div>
									<!-- end empty header  -->
									<!-- preview -->
									<div id="preview" style="DISPLAY: none">
										<fieldset>
											<legend align="left">Preview</legend>
											<table border=0 cellspacing=0 cellpadding=4 width=100%>
												<tr>
													<td>
														<span id="previewimgname"></span>
														<br><img src="/images/clearpixel.gif" width=1 height=1 border=1 ID="previewimg" name="previewimg" OnError="document.images.test.src='/images/clearpixel.gif'" style="border-color: #cccccc">
													</td>
												</tr>
											</table>
										</fieldset>
									</div>
									<!-- end preview -->
									<!-- folder properties -->
									<div id="loading" style="DISPLAY: none">
										<fieldset>
											<legend align="left"><span id="foldername"></span> &nbsp;images folder</legend>
											<table border=0 cellspacing=0 cellpadding=4 width=100%>
												<tr><td><span id="owner"></span></td></tr>
												<tr><td><span id="amoutitems"></span></td></tr>
												<tr><td><span id="uploadallow"></span></td></tr>
												<tr><td><span id="showallow"></span></td></tr>
												<tr><td><span id="foldereditlink_disabled"></span></td></tr>
											</table>
											<!-- upload table -->	
											<script src="../../../images/upload.js"></script>
											<script language="JavaScript">
											max = 101024;
											nopic = 0
											
											function showFolderInfo(name, id, owner, amount, ul, ps){
												document.getElementById('foldername').innerHTML = name;
												document.getElementById('owner').innerHTML = 'Owner: ' + owner;
												document.getElementById('amoutitems').innerHTML = 'Contains ' + amount + ' images';
												document.getElementById('uploadallow').innerHTML = ul;
												document.getElementById('showallow').innerHTML =  ps;
												document.images['invis'].src='/images/clearpixel.gif';
												showLayer('loading');
												hideLayer('preview');
												hideLayer('emptyheader');
											}
											</script>
											<!-- end upload table -->
											<!-- end folder properties -->
										</fieldset>
									</div>
								</td>
							</tr>
						</table>
						<div id="Layer2" style="overflow: scroll; position:absolute; top: 50px; width:200px; height:100px; rect(50px 80px 80px 50px); z-index:1;  visibility: hidden"><img src="/images/clearpixel.gif" border=0 ID="invis" style="z-index: 1" onLoad="resize()"><img src="/images/clearpixel.gif" width=1 height=1 border=1 id="test" OnError="document.images.test.src='/images/clearpixel.gif'">
						</div>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
  <table border="0" cellpadding="0" cellspacing="5" width="300">
    <tr>
      <td align="center" valign="middle"><fieldset>
						<legend align="left">{$lang_insert_image_title}</legend>
			<table border="0" cellpadding="4" cellspacing="0" width="300">
          <tr>
            <td nowrap="nowrap">{$lang_insert_image_src}:</td>
            <td><table border="0" cellspacing="0" cellpadding="0">
                <tr>
                  <td><input name="src" type="text" id="src" value="" style="width: 293px" onchange="getImageData();"></td>
                  <td id="browser"></td>
                </tr>
              </table></td>
          </tr>
		  <!-- Image list -->
		  <script language="javascript">
			if (typeof(tinyMCEImageList) != "undefined" && tinyMCEImageList.length > 0) {
				var html = "";

				html += '<tr><td>{$lang_image_list}:</td>';
				html += '<td><select name="image_list" style="width: 393px" onchange="this.form.src.value=this.options[this.selectedIndex].value;resetImageData();getImageData();">';
				html += '<option value="">---</option>';

				for (var i=0; i<tinyMCEImageList.length; i++)
					html += '<option value="' + tinyMCEImageList[i][1] + '">' + tinyMCEImageList[i][0] + '</option>';

				html += '</select></td></tr>';

				document.write(html);
			}
		  </script>
		  <!-- /Image list -->
          <tr>
            <td nowrap="nowrap">{$lang_insert_image_alt}:</td>
            <td><input name="alt" type="text" id="alt" value="" style="width: 293px"></td>
          </tr>
          <tr>
            <td nowrap="nowrap">{$lang_insert_image_align}:</td>
            <td><select name="align">
                <option value="">{$lang_insert_image_align_default}</option>
                <option value="baseline">{$lang_insert_image_align_baseline}</option>
                <option value="top">{$lang_insert_image_align_top}</option>
                <option value="middle">{$lang_insert_image_align_middle}</option>
                <option value="bottom">{$lang_insert_image_align_bottom}</option>
                <option value="texttop">{$lang_insert_image_align_texttop}</option>
                <option value="absmiddle">{$lang_insert_image_align_absmiddle}</option>
                <option value="absbottom">{$lang_insert_image_align_absbottom}</option>
                <option value="left">{$lang_insert_image_align_left}</option>
                <option value="right">{$lang_insert_image_align_right}</option>
              </select></td>
          </tr>
          <tr>
            <td nowrap="nowrap">{$lang_insert_image_dimensions}:</td>
            <td><input name="width" type="text" id="width" value="" size="3" maxlength="3">
              x
              <input name="height" type="text" id="height" value="" size="3" maxlength="3"></td>
          </tr>
          <tr>
            <td nowrap="nowrap">{$lang_insert_image_border}:</td>
            <td><input name="border" type="text" id="border" value="" size="3" maxlength="3"></td>
          </tr>
          <tr>
            <td nowrap="nowrap">{$lang_insert_image_vspace}:</td>
            <td><input name="vspace" type="text" id="vspace" value="" size="3" maxlength="3"></td>
          </tr>
          <tr>
            <td nowrap="nowrap">{$lang_insert_image_hspace}:</td>
            <td><input name="hspace" type="text" id="hspace" value="" size="3" maxlength="3"></td>
          </tr>
          <tr>
            <td nowrap="nowrap"><input type="button" id="insert" name="insert" value="{$lang_insert}" onclick="insertImage();">
            </td>
            <td align="right"><input type="button" id="cancel" name="cancel" value="{$lang_cancel}" onclick="cancelAction();"></td>
          </tr>
        </table></fieldset></td>
    </tr>
  </table>
			<input type="hidden" id="img_id" name="img_id" value="">
			<div id="removebutton" style="DISPLAY: none">

</form>




</body> 
</html> 
